<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Movies on Freeview</title>

		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width,initial-scale=1"/>
		<meta name="X-UA-Compatible" content="IE=edge,chrome=1"/>
		<meta name="HandheldFriendly" content="true"/>

		<meta name="description" content=""/>

		<meta property="og:image" content="./facebook.jpg">
		<link rel="image_src" href="./facebook.jpg">

		<link href="http://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/>
		<link href="http://fonts.googleapis.com/css?family=Oswald:400,700" rel="stylesheet" type="text/css"/>

		<link type="text/css" rel="stylesheet" media="all" href="./css/reset.css"/>
		<link type="text/css" rel="stylesheet" media="all" href="./css/main.css"/>

		<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

		<!--[if lt IE 9]> <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
	</head>

	<body ng-app="myapp">
		<div ng-controller="MyController" class="main">
			<div id="controlsArea" ng-cloak>
				<div id="controls" class="selfClearing" ng-class="{active: controlsActive}">
					<div class="inner">
						<p>See all movies showing on popular Freeview channels over the next seven days.</p>
						<p>Use the filters below to narrow down the ones you want to watch.</p>

						<div class="filter large">
							<button ng-click="currentFilter = 'sort';"     ng-class="{active: currentFilter === 'sort'}    "><span class="fa fa-sort-amount-asc fa-2x"></span>Sort</button>
							<button ng-click="currentFilter = 'score';"    ng-class="{active: currentFilter === 'score'}   "><span class="fa fa-star-o fa-2x"></span>Score</button>
							<button ng-click="currentFilter = 'duration';" ng-class="{active: currentFilter === 'duration'}"><span class="fa fa-clock-o fa-2x"></span>Duration</button>
							<button ng-click="currentFilter = 'channels';" ng-class="{active: currentFilter === 'channels'}"><span class="fa fa-tablet fa-2x"></span>Channels</button>
							<button ng-click="currentFilter = 'day';"      ng-class="{active: currentFilter === 'day'}     "><span class="fa fa-calendar fa-2x"></span>Day</button>
							<button ng-click="currentFilter = 'decade';"   ng-class="{active: currentFilter === 'decade'}  "><span class="fa fa-calendar-o fa-2x"></span>Released</button>
						</div>

						<div class="filter" ng-show="currentFilter === 'sort';">
							<button ng-click="predicate = 'title'; reverse = false;" ng-class="{active: predicate === 'title'}">A-Z</button>
							<button ng-click="predicate = 'score'; reverse = true;"  ng-class="{active: predicate === 'score'}">Score</button>
							<button ng-click="predicate = 'year';  reverse = true;"  ng-class="{active: predicate === 'year' }">Newest</button>
						</div>

						<div class="filter" ng-show="currentFilter === 'score';">
							<button ng-click="filters.minScore = 0;"  ng-class="{active: filters.minScore === 0} ">&lt;3</button>
							<button ng-click="filters.minScore = 3;"  ng-class="{active: filters.minScore === 3} ">3</button>
							<button ng-click="filters.minScore = 4;"  ng-class="{active: filters.minScore === 4} ">4</button>
							<button ng-click="filters.minScore = 5;"  ng-class="{active: filters.minScore === 5} ">5</button>
							<button ng-click="filters.minScore = 6;"  ng-class="{active: filters.minScore === 6} ">6</button>
							<button ng-click="filters.minScore = 7;"  ng-class="{active: filters.minScore === 7} ">7</button>
							<button ng-click="filters.minScore = 8;"  ng-class="{active: filters.minScore === 8} ">8</button>
							<button ng-click="filters.minScore = 9;"  ng-class="{active: filters.minScore === 9} ">9</button>
							<button ng-click="filters.minScore = 10;" ng-class="{active: filters.minScore === 10}">10</button>
						</div class="filter">

						<div class="filter" ng-show="currentFilter === 'duration';">
							<button ng-click="filters.maxDuration = 2;"  ng-class="{active: filters.maxDuration === 2}">&lt;2</button>
							<button ng-click="filters.maxDuration = 3;"  ng-class="{active: filters.maxDuration === 3}">&lt;3</button>
							<button ng-click="filters.maxDuration = 4;"  ng-class="{active: filters.maxDuration === 4}">&lt;4</button>
							<button ng-click="filters.maxDuration = 9;"  ng-class="{active: filters.maxDuration === 9}">4+</button>
						</div>

						<div class="filter" ng-show="currentFilter === 'channels';">
							<button ng-click="toggleFilter('channels', 'bbc');"   ng-class="{active: filters.channels['bbc'  ]}">BBC</button>
							<button ng-click="toggleFilter('channels', 'itv');"   ng-class="{active: filters.channels['itv'  ]}">ITV</button>
							<button ng-click="toggleFilter('channels', 'four');"  ng-class="{active: filters.channels['four' ]}">Four</button>
							<button ng-click="toggleFilter('channels', 'five');"  ng-class="{active: filters.channels['five' ]}">Five</button>
							<button ng-click="toggleFilter('channels', 'other');" ng-class="{active: filters.channels['other']}">Other</button>
						</div>

						<div class="filter" ng-show="currentFilter === 'day';">
							<button ng-click="filters.day = 'today';"    ng-class="{active: filters.day === 'today'   }">Today</button>
							<button ng-click="filters.day = 'tomorrow';" ng-class="{active: filters.day === 'tomorrow'}">2moro</button>
							<button ng-click="filters.day = '7days';"    ng-class="{active: filters.day === '7days'   }">7 Days</button>
						</div>

						<div class="filter" ng-show="currentFilter === 'decade';">
							<button ng-click="toggleFilter('decades', '40');" ng-class="{active: filters.decades['40']}">40s</button>
							<button ng-click="toggleFilter('decades', '50');" ng-class="{active: filters.decades['50']}">50s</button>
							<button ng-click="toggleFilter('decades', '60');" ng-class="{active: filters.decades['60']}">60s</button>
							<button ng-click="toggleFilter('decades', '70');" ng-class="{active: filters.decades['70']}">70s</button>
							<button ng-click="toggleFilter('decades', '80');" ng-class="{active: filters.decades['80']}">80s</button>
							<button ng-click="toggleFilter('decades', '90');" ng-class="{active: filters.decades['90']}">90s</button>
							<button ng-click="toggleFilter('decades', '00');" ng-class="{active: filters.decades['00']}">00s</button>
							<button ng-click="toggleFilter('decades', '10');" ng-class="{active: filters.decades['10']}">10s</button>
						</div>
					</div>
				</div>

				<button id="controlsToggle" ng-click="controlsActive = !controlsActive;">Toggle filters</button>
			</div>

			<div ng-show="error" id="error" class="fillPage" ng-cloak>{{errorMessage}}</div>

			<div ng-show="!loaded && !error" id="loading" class="fillPage">Loading</div>

			<div id="results" class="selfClearing" ng-show="loaded && !error" ng-cloak>
				<div ng-repeat="film in filtered = (films | orderBy:predicate:reverse | filmsFilter:this.filters:this.channels)" class="film">
					<div style="background-image: url({{baseUrl}}w185{{film.poster}});" class="poster">
						<div class="detail">
							<div class="inner">
								<h1>{{film.title}}</h1>

								<div class="showings">
									<div ng-repeat="showing in film.showings | orderBy:timestamp" class="showing">
										<h2>{{channels[showing.channel].title}}</h2>
										{{showing.date}} - {{showing.start}}
									</div>
								</div>

								<div class="attributes selfClearing">
									<div class="attribute"><span class="fa fa-star-o" title="Score"></span> {{film.score}}</div>
									<div class="attribute"><span class="fa fa-clock-o" title="Duration"></span> {{film.duration}}</div>
									<div class="attribute"><span class="fa fa-calendar-o" title="Released"></span> {{film.year}}</div>
									<!-- <a href="http://en.wikipedia.org/w/index.php?title=Special%3ASearch&profile=default&search={{film.title}}+{{film.year}}+film&fulltext=Search" target="_blank"><div class="attribute"><span class="fa fa-globe" title="Wikipedia"></span> Summary</div></a> -->
									<!-- <a href="https://www.youtube.com/results?search_query={{film.title}}+{{film.year}}+film+trailer" target="_blank"><div class="attribute"><span class="fa fa-youtube" title="YouTube"></span> Trailer</div></a> -->
								</div>
							</div>
						</div>
					</div>
				</div>

				<div ng-show="filtered.length === 0" id="noResults" class="fillPage">No results</div>
			</div>

			<footer>
				Built by <a href="http://www.lostincode.co.uk" target="_blank">David</a> |
				Movie metadata supplied by <a href="#" target="_blank">TMDB</a> |
				Showing times supplied by <a href="#" target="_blank">Sky</a> |
				Film reel icon designed by <a href="#" target="_blank">Bob</a>
			</footer>
		</div>


		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.8/angular.min.js"></script>
		<script src="./js/vendor/moment.js"></script>
		<script src="./js/main.js"></script>
	</body>
</html>