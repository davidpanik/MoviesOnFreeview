<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Movies on Freeview</title>

		<meta charset="utf-8"/>
		<meta name="viewport" content="width=device-width,initial-scale=1"/>
		<meta name="X-UA-Compatible" content="IE=edge,chrome=1"/>
		<meta name="HandheldFriendly" content="true"/>

		<meta name="description" content=""/>

		<meta property="og:image" content="./facebook.jpg">
		<link rel="image_src" href="./facebook.jpg">

		<link type="text/css" rel="stylesheet" media="all" href="./css/reset.css"/>
		<link type="text/css" rel="stylesheet" media="all" href="./css/main.css"/>

		<!--[if lt IE 9]> <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
	</head>

	<body ng-app="myapp">
		<div ng-controller="MyController">
			<div id="controls" class="selfClearing" ng-class="{active: controlsActive}">
				<button id="controlsFilter" ng-click="controlsActive = !controlsActive;">Toggle controls</button>

				<div class="inner">
					<div class="filter">
						<span>Sort:</span>
						<button ng-click="predicate = 'title'; reverse = false;" ng-class="{active: predicate === 'title'}">Alphabetical</button>
						<button ng-click="predicate = 'score'; reverse = true;"  ng-class="{active: predicate === 'score'}">Top Rated</button>
						<button ng-click="predicate = 'year';  reverse = true;"  ng-class="{active: predicate === 'year' }">Newest</button>
					</div>

					<div class="filter">
						<span>Score:</span>
						<button ng-click="filters.minScore = 5;"  ng-class="{active: filters.minScore === 5} ">5</button>
						<button ng-click="filters.minScore = 6;"  ng-class="{active: filters.minScore === 6} ">6</button>
						<button ng-click="filters.minScore = 7;"  ng-class="{active: filters.minScore === 7} ">7</button>
						<button ng-click="filters.minScore = 8;"  ng-class="{active: filters.minScore === 8} ">8</button>
						<button ng-click="filters.minScore = 9;"  ng-class="{active: filters.minScore === 9} ">9</button>
						<button ng-click="filters.minScore = 10;" ng-class="{active: filters.minScore === 10}">10</button>
					</div class="filter">

					<div class="filter">
						<span>Duration:</span>
						<button ng-click="filters.maxDuration = 2;"  ng-class="{active: filters.maxDuration === 2}">&lt;2</button>
						<button ng-click="filters.maxDuration = 3;"  ng-class="{active: filters.maxDuration === 3}">&lt;3</button>
						<button ng-click="filters.maxDuration = 4;"  ng-class="{active: filters.maxDuration === 4}">&lt;4</button>
						<button ng-click="filters.maxDuration = 9;"  ng-class="{active: filters.maxDuration === 9}">4+</button>
					</div>

					<div class="filter">
						<span>Channels:</span>
						<button ng-click="toggleFilter('channels', 'bbc');"   ng-class="{active: filters.channels['bbc'  ]}">BBC</button>
						<button ng-click="toggleFilter('channels', 'itv');"   ng-class="{active: filters.channels['itv'  ]}">ITV</button>
						<button ng-click="toggleFilter('channels', 'four');"  ng-class="{active: filters.channels['four' ]}">Four</button>
						<button ng-click="toggleFilter('channels', 'five');"  ng-class="{active: filters.channels['five' ]}">Five</button>
						<button ng-click="toggleFilter('channels', 'other');" ng-class="{active: filters.channels['other']}">Other</button>
					</div>

					<div class="filter">
						<span>Day:</span>
						<button ng-click="toggleFilter('days', 'today');"    ng-class="{active: filters.days['today'   ]}">Today</button>
						<button ng-click="toggleFilter('days', 'tomorrow');" ng-class="{active: filters.days['tomorrow']}">Tomorrow</button>
						<button ng-click="toggleFilter('days', '7days');"    ng-class="{active: filters.days['7days'   ]}">Next 7 Days</button>
					</div>

					<div class="filter">
						<span>Decade:</span>
						<button ng-click="toggleFilter('decades', '40_50');" ng-class="{active: filters.decades['40_50']}">40s 50s</button>
						<button ng-click="toggleFilter('decades', '60_70');" ng-class="{active: filters.decades['60_70']}">60s 70s</button>
						<button ng-click="toggleFilter('decades', '80_90');" ng-class="{active: filters.decades['80_90']}">80s 90s</button>
						<button ng-click="toggleFilter('decades', '00_10');" ng-class="{active: filters.decades['00_10']}">00s 10s</button>
					</div>
				</div>
			</div>

			<div ng-show="error" id="error">{{errorMessage}}</div>

			<div ng-show="!loaded && !error" id="loading">Loading...</div>

			<div id="results" class="selfClearing" ng-show="loaded && !error">
				<div ng-repeat="film in filtered = (films | orderBy:predicate:reverse | filmsFilter:this.filters:this.channels)" class="film">
					<div style="background-image: url({{baseUrl}}w185{{film.poster}});" class="poster">
						<div class="detail">
							<div class="inner">
								<h1>{{film.title}}</h1>
								<p>Score: {{film.score}}</p>
								<p>Duration: {{film.duration}}</p>
								<p>Year: {{film.year}}</p>
								<p><a href="http://en.wikipedia.org/w/index.php?title=Special%3ASearch&profile=default&search={{film.title}}+{{film.year}}+film&fulltext=Search" target="_blank">Wikipedia</a></p>
								<p><a href="https://www.youtube.com/results?search_query={{film.title}}+{{film.year}}+film+trailer" target="_blank">YouTube</a></p>
								<ul>
									<li ng-repeat="showing in film.showings | orderBy:timestamp">
										{{channels[showing.channel].title}} - {{showing.date}} - {{showing.start}}
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>

				<div ng-show="filtered.length === 0" class="noResults">No results!</div>
			</div>
		</div>

		<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.8/angular.min.js"></script>
		<script src="./js/vendor/moment.js"></script>
		<script src="./js/main.js"></script>
	</body>
</html>